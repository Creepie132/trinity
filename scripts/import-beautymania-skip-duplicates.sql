-- Import clients for beautymania with duplicate phone check
-- org_id: 1e77c781-3848-4b16-a623-693de123c6bc

DO $$
DECLARE
  v_org_id UUID := '1e77c781-3848-4b16-a623-693de123c6bc';
  v_count INT := 0;
BEGIN
  -- Insert only if phone doesn't exist in the ENTIRE system
  INSERT INTO clients (org_id, first_name, last_name, phone, email, address, date_of_birth, notes)
  SELECT * FROM (VALUES
    (v_org_id, 'Елена', 'Бобровицкая', '537268565', null::text, 'Yefe Nof St 31 Ashkelon', '2026-01-08'::date, 'Источник: Facebook. Последний визит: 2026-01-08'),
    (v_org_id, 'Натали', 'Верховски', '534214164', null::text, 'Goldberg ha-Nadvan St 14 Rishon LeZion', '2026-01-08'::date, 'Источник: Facebook. Последний визит: 2026-01-08'),
    (v_org_id, 'Диана', 'Фурман', '546354076', null::text, 'Derech Dganya 84 6 Netanya', '2026-01-05'::date, 'Последний визит: 2026-01-05'),
    (v_org_id, 'Влад', 'Халфин', '544858586', null::text, 'Lakhish St 3 Ashkelon', null::date, null::text),
    (v_org_id, 'Женя', 'Ярусская', '546122467', null::text, 'דרך הים 96 Ashkelon', null::date, 'Источник: Лично'),
    (v_org_id, 'Александра', 'Гринкруг', '504865949', null::text, 'Nahman Syrkin St 19/11 Ashdod', null::date, 'Источник: Facebook'),
    (v_org_id, 'Ирина', 'Чинонова', '559898283', null::text, 'Pki''in St 6/14 Ashkelon', null::date, 'Источник: личное знакомство'),
    (v_org_id, 'Сабина', 'Сабина', '559724118', null::text, 'Meron St 17 1 Karmiel', null::date, 'Источник: Facebook'),
    (v_org_id, 'Марианна', 'Садовская', '539649919', null::text, 'Petakh Tikva St 11 Ashdod 7765772', null::date, 'Источник: Facebook'),
    (v_org_id, 'Людмила', 'Шишело', '534310488', null::text, 'Bialik St 17 3 Ra''anana', null::date, 'Источник: Facebook'),
    (v_org_id, 'Натали', 'Бакланов', '542438316', null::text, 'Zeev Jabotinsky St Ramat Gan', null::date, 'Источник: Facebook'),
    (v_org_id, 'Таня', 'Ройтман', '542116466', null::text, 'Sokolov St 132 1 Holon', null::date, 'Источник: Facebook'),
    (v_org_id, 'Инна', 'Данич', '528898757', null::text, 'נעמי שמר 8 חולון', null::date, 'Источник: Facebook'),
    (v_org_id, 'Алона', 'Редкина', '546538120', null::text, 'Har Metsada St 95 Ashdod', null::date, 'Источник: Facebook'),
    (v_org_id, 'Евгения', 'Меламед', '543673277', null::text, 'Shlomo ha-Melekh St 5 Ashdod', null::date, null::text),
    (v_org_id, 'Руфина', 'Светлицкий', '547659880', null::text, 'Yehoshu''a Bin Nun St 21 Ofakim', null::date, 'Источник: Facebook'),
    (v_org_id, 'Алёна', 'Авруцкая', '528097070', null::text, 'Arlozorov St 21 Ashdod', '1984-07-31'::date, 'Источник: Facebook'),
    (v_org_id, 'Татьяна', 'Щербич', '544413029', null::text, 'Bayit Vagan St 15 Bat Yam', '1976-11-05'::date, 'Источник: Facebook'),
    (v_org_id, 'Ирина', 'Карцемский', '502339450', null::text, 'Nordau St 1 Ness Ziona', '1970-04-29'::date, 'Источник: Facebook'),
    (v_org_id, 'טניה', 'סורוקין קורינוי', '5472819533', null::text, 'רמלה משה לוי 24/7', null::date, 'קיבלה מתנה קרם ידיים חסר קרם גוף 10.02.24'),
    (v_org_id, 'Marina', 'Nahshan', '506552804', null::text, 'חיפה דרך הים 193 א דירה 1', null::date, 'נשלחה מתנה קרם ידיים או ג'' לרחצה 07.02.24'),
    (v_org_id, 'טטיאנה', 'גופמן', '525838523', null::text, 'באר שבע בר ניסן 25/35', null::date, 'נשלח בדואר 3 7.02.24'),
    (v_org_id, 'Olga', 'Tkachenko', '532869789', null::text, 'כרמיאל שביל טבת 3', null::date, 'נשלח בדואר חסר קרם גוף + מתנה 7/02/24'),
    (v_org_id, 'Lika', 'Mizonova', '538218058', null::text, 'אשקלון שי עגנון 23/5', null::date, 'סופק 05.02.24'),
    (v_org_id, 'Ella', 'Sherkin', '522271891', null::text, 'נוף הגליל אלומה 2/7 1709207', null::date, 'לא נשלח עדיין'),
    (v_org_id, 'Hanna', 'Pristupa', '522196990', null::text, 'נתניה ויצמן 8/3', null::date, 'נשלח 7.02.24 + מתנה חסר קרם גוף'),
    (v_org_id, 'ויקטוריה', 'מזור', '548385063', null::text, 'ראשון לציון שלמה לוי 42/8', null::date, 'קיבלה מתנה קרם ידיים חסר 3 קרם גוף 9.02.24'),
    (v_org_id, 'אליסה', 'אליסוב', '528513128', null::text, 'אשקלון ביאליק 63', null::date, 'לא קיבלה עדיין'),
    (v_org_id, 'מאיה', 'יורוב', '526861790', null::text, 'פתח תקווה השלושה 1/9', null::date, 'נשלח בדואר חסר קרם גוף + מתנה 7.02.24'),
    (v_org_id, 'יבגניה', 'מטייב', '526566205', null::text, 'שדרות פינס 5/2', null::date, 'סופק 6.02.24'),
    (v_org_id, 'גלנה', 'וויטקובסקי', '548671182', null::text, 'מעלות תרשיחה התומר 6/7', null::date, 'נשלח בדואר חסר קרם גוף ומתנה 7.02.24'),
    (v_org_id, 'נדיה', 'אנטונובа', '528311041', null::text, 'תל אביב דרך חיים בר לב 165/13', null::date, 'סופק לבית 8.02.24 חסר 2 קרם גוף: A ו-B'),
    (v_org_id, 'מילנה', 'סירוטה', '547207633', null::text, 'ראשון לציון זבוטינסקי 105/331', null::date, 'סופק עד הבית 08.02.24'),
    (v_org_id, 'Alexandra', 'Gusein', '524048062', null::text, 'רחובות אחד העם 26', null::date, 'סופק לבית 9.02.24 חסר קרפ גוף ומתנה'),
    (v_org_id, 'נטלי', 'פשקוב', '547953631', null::text, 'אשקלון דוריף 1/26', null::date, 'סופק לבי 05.02.24 חסר קרם גוף ומתנה'),
    (v_org_id, 'Sveta', 'Cussi', '547459449', null::text, 'אשדוד הבושם 12', null::date, 'סופק לבית 9.02.24 חסר קרם גוף ומתנה'),
    (v_org_id, 'לנה', 'אבורצי', '504571006', null::text, 'אשקלון אפרים צור 4', null::date, 'תשלום במקום עדיין לא סופק'),
    (v_org_id, 'Таня', '', '532768393', null::text, 'אשדוד רותם 45/9', null::date, 'סופק לבית 9.02.24'),
    (v_org_id, 'Инна', 'Авруцкий', '525508572', null::text, 'אשדוד ארלוזורוב 20/21', null::date, 'סופק 9.02.24 חסר קרם גוף ומתנה! שולם הכל'),
    (v_org_id, 'Albina', 'Kalikhman', '532403290', null::text, 'אשקלון אפלמ"ח 44/12', null::date, 'סופק 10.02.24 חסר קרם גוף'),
    (v_org_id, 'Марина', 'Партигул', '527902604', null::text, 'חולון קפאח 7 דירה 6', null::date, 'Оплатила 240 шек'),
    (v_org_id, 'Татьяна', 'Левин', '542052952', null::text, 'בת ים המלאכה טל.', null::date, 'Оплачено 190 шек. Доставка с 9 до 16'),
    (v_org_id, 'איוונה', 'סבצ''וק', '542151542', null::text, 'טבריה אחשמונאים 12', null::date, 'Оплата 240 שек при получении'),
    (v_org_id, 'קטיה', 'גרומוב', '547506533', null::text, 'תל אביב דרך ההגנה 136', null::date, 'לספק לתל אביב קופסת לב'),
    (v_org_id, 'נטליה', 'דולגליוב', '507165523', null::text, 'כרמיאל מישעול סייפן 20/2 2175102', null::date, 'К оплате наличными 240 שק'),
    (v_org_id, 'Шуля', 'Примак', '528581098', null::text, 'Ашкелон эмек израэль 11 кв 5', null::date, 'Оплачено 120 שק'),
    (v_org_id, 'ויקטוריה', 'גוטמן', '542838293', null::text, 'קרית אתא יוספטל 7', null::date, 'ДВА набора оплачено оба с Луи Виттон. Оплачено 480 שק'),
    (v_org_id, 'Yulia', 'Ayusheev', '508185566', null::text, 'ק.מוצקין בן גוריון 29/71 מיקוד 2642426', null::date, 'Оплатила 240 שק'),
    (v_org_id, 'Марина', 'Брон', '504321949', null::text, 'Кирьят Моцкин צהייל 5', null::date, 'Оплатила 240 שק'),
    (v_org_id, 'Мила', 'Фридланд', '546444093', null::text, 'Тель-Авив Нахалат Ицхак 10', null::date, 'Позвонить перед отправкой'),
    (v_org_id, 'יאנה', 'ריאבוי', '526962257', null::text, 'חולון הנרייטה סולד 60', null::date, 'Оплатила 190 שק'),
    (v_org_id, 'Маша', 'Дашко', '544666691', null::text, 'מרכז גולברי סקארה לוגיסטי צריפין ניר צבי', null::date, 'Нир Цви Оплачено 240 שק'),
    (v_org_id, 'אוקסנה', 'יורובסקי', '526392735', null::text, 'אשקלון אלי כהן 37 אשקלון דירה 35', null::date, 'Оплачено 240 שק'),
    (v_org_id, 'Наталия', 'Литвинчук', '542438316', null::text, 'Рамат Ган Зеев Жаботински 43', null::date, 'Оплачено 190 שק'),
    (v_org_id, 'ולריה', 'פינקל', '523394522', null::text, 'נתניה אזוה"ת יקום לייד שפיים בניין A איטליה.', null::date, 'Позвонить перед доставкой Оплатила 120 שק'),
    (v_org_id, 'אירינה', 'מדבדובסקי', '55261027', null::text, 'אשקלון אפרסמון', null::date, 'подарок'),
    (v_org_id, 'Елена', 'Кавук', '546573377', null::text, 'חולון ההסתדרות 209', null::date, 'доставлено'),
    (v_org_id, 'אירינה', 'אייזן', '526210416', null::text, 'אשקלון הנוער העובד 3/4', null::date, 'оплачено'),
    (v_org_id, 'אלפירה', 'יארושבסקי', '542013720', null::text, 'כרמיאל מבצע עובדה 6/38', null::date, 'оплачено'),
    (v_org_id, 'ילנה', 'צירולניק', '526454653', null::text, 'יקנעם עילית דרך הארגמן 19/15', null::date, 'оплачено'),
    (v_org_id, 'ילנה', 'גרינברג', '507166368', null::text, 'פתח תקווה הראשונים 1', null::date, 'оплачено'),
    (v_org_id, 'ויקטוריה', '', '547824419', null::text, 'אשדוד כסלו 23', null::date, 'оплачено'),
    (v_org_id, 'אניה', 'שניידר', '548130262', null::text, 'אופקים קיבוץ גלויות', null::date, 'оплачено'),
    (v_org_id, 'ורוניקה', 'קיומוב', '508137978', null::text, 'מעלה אדומים האלה 28', null::date, 'оплата на неправильный бит ожидаем отмену'),
    (v_org_id, 'אנגלה', 'בורוכוב', '525873415', null::text, 'אופקים פרי מגדים 32', null::date, 'оплачено 480'),
    (v_org_id, 'Kseniya', 'Chail', '528445019', null::text, 'רמלה מרדכי סעדיה 9 ב/27', null::date, 'Оплачено 190 שק'),
    (v_org_id, 'אירינה', 'סמירנוב', '546688812', null::text, 'כרמיאל חטיבת יפתח 9/64 2199274', null::date, 'Оплачено 240 שק'),
    (v_org_id, 'נדזידה', 'קוציקוניאן', '526247615', null::text, 'באר שבע חרב טנא שלמה 27/12', null::date, 'У нее еще гель для душа с 1 ароматом оплатила 310 שק'),
    (v_org_id, 'טטיאנה', 'צ''אלי', '527363122', null::text, 'בת ים דרך יצחק שדה 33', null::date, 'Оплата наличными 240 שק'),
    (v_org_id, 'טניה', 'סטרלצוב', '537834361', null::text, 'אשקלון עיר היין שאנין 9/2', null::date, 'У нее др 4 марта хочет получить до праздника. Оплата наличными 240 שק'),
    (v_org_id, 'יוליה', 'גרובשטיין', '544684756', null::text, 'ראשון לציון הנגיד 11 דירה 6 7548211', null::date, 'У нее два крема для рук будет. Она оплатила с доставкой 170 שק'),
    (v_org_id, 'Ира', 'Дроботун', '505833376', null::text, 'פתח תקווה הרב פינטו מסעוד 2 דירה 38', null::date, 'Оплатила 240 שק'),
    (v_org_id, 'ראיסה', 'חוטין', '526285848', null::text, 'נהריה 2222711 אשכול 3/11', null::date, 'У нее два набора будет оплатила с доставкой 510 שק'),
    (v_org_id, 'Tati', 'Voda', '542267206', null::text, 'נהריה 2226092 נשר 33/4', null::date, 'оплачено на бит'),
    (v_org_id, 'ילנה', 'גילר', '546908777', null::text, 'אשקלון אלי כהן 5/43', null::date, 'Оплачено 240 שק она будет ждать крем для рук'),
    (v_org_id, 'אוקסנה', 'פרחומנקו', '525971436', null::text, 'טבריה המכבים 2 דירה 6', null::date, 'Оплатила 270 שק с доставкой'),
    (v_org_id, 'Аня', 'Кузнецова', '586500777', null::text, 'אשדוד המלך אמציה 18', null::date, 'Оплатила 270 שק с доставкой'),
    (v_org_id, 'סבטלנה', 'לוי', '544873730', null::text, 'ראש העין יוסף מלאכי 9 ראש העין טל. 4851509', null::date, 'Оплатила 270 שק с доставкой'),
    (v_org_id, 'ילנה', 'קולודין', '503366205', null::text, 'באר יעקב קציר 11 באר יעקב', null::date, 'Оплатила 300 שק за набор + доставка'),
    (v_org_id, 'Валентина', 'Спектор', '544798115', null::text, 'Бат ям эли Коэн 24/21', null::date, 'К оплате НАЛИЧНЫМИ 230 שק включая доставку'),
    (v_org_id, 'אירנה', 'וייסמן', '507422975', null::text, 'לוד צמרות 6 לוד', null::date, 'У нее ДВА геля для душа будет Оплатила с доставкой 300'),
    (v_org_id, 'לודמילה', 'שירמן', '584215453', null::text, 'אריאל 4076030 הערבה 65 דירה 5', null::date, 'Оплатила 300 שק с доставкой'),
    (v_org_id, 'Ирина', 'Карачунски', '543551510', null::text, 'אשקלון הציונות 55', null::date, 'Оплатила 200 שק доставка по Ашкелону бесплатная'),
    (v_org_id, 'אנה', 'זסלבסקי', '545998011', null::text, 'Ашкелон משה ובר 8 דירה 22', null::date, 'Оплатила 140 שק доставка по Ашкелону бесплатная'),
    (v_org_id, 'נטליה', 'גלבר בנשיטרית', '522800650', null::text, 'אשדוד נחל לכיש 31/31', null::date, 'Оплатила 160 שק включая доставку'),
    (v_org_id, 'Юлия', 'Петрова', '524232201', null::text, 'פתח תקווה שטפמפפר 76 דירה 4', null::date, 'Оплатила 160 שק с доставкой чек скинула тебе в вотсап'),
    (v_org_id, 'Eleonora', 'Lashenko', '545458188', null::text, 'נוף הגליל קישון 11/472', null::date, 'Оплачено 300 שק с доставкой'),
    (v_org_id, 'Оксана', 'Нестеребски', '523250690', null::text, 'Ашкелон Ашкелон-Неве-Адарим. Ул. Нисан-26א-кв-1', null::date, 'К оплате наличными 270 שק'),
    (v_org_id, 'Irina', 'Baskina', '522253869', null::text, 'אשדוד רח'' הרי גולן 17 דירה 21', null::date, 'Оплатила 270 доставка в подарок'),
    (v_org_id, 'Элла', 'Зац', '544724755', null::text, 'Ашдод Анна Франк 4', null::date, 'Оплата 270 שק доставка в подарок'),
    (v_org_id, 'בסילינה', 'דונדיש', '523224320', null::text, 'Ашкелон כל ישראל חברים 61', null::date, 'К оплате 270 שק наличными по Ашкелону бесплатная доставка'),
    (v_org_id, 'אוקסנה', 'רוזנברג', '552361530', null::text, 'באר שבע החידה 103 דירה 32', null::date, 'ПЛЮС МУЖСКОЙ ГЕЛЬ ДЛЯ ДУША к оплате наличными 280 שק'),
    (v_org_id, 'Yulia', 'Kra', '526017570', null::text, 'אשדוד הרב הרצוג 18/18', null::date, 'Плюс МУЖСКОЙ КРЕМ оплатила 330'),
    (v_org_id, 'ולריה', 'קובליוב', '526147954', null::text, 'אשדוד המלך שלמה 6/48', null::date, 'Плюс ДВА ГЕЛЯ МУЖСКИХ оплатила 300 שק'),
    (v_org_id, 'Светлана', 'Дуберман', '532270827', null::text, 'אשדוד אבות ישורון 28/5', null::date, 'К оплате наличными 270 שק хочет забрать самовывозом ДО 4 ИЮНЯ'),
    (v_org_id, 'אירינה', 'פילטוב', '525484599', null::text, 'רחובות מירון 7 ב דירה 22', null::date, 'ПЛЮС МУЖСКОЙ НАБОР оплатила за все 480 שק'),
    (v_org_id, 'מרינה', 'מישנקו', '548106230', null::text, 'אשקלון שפירא 6/67', null::date, 'Плюс МУЖСКОЙ ГЕЛЬ ДЛЯ ДУША оплатила 220 שק'),
    (v_org_id, 'Света', 'Розенфед', '543265548', null::text, 'Явне Шабизи 1/14', null::date, 'Оплатила 540 שק ПРОСИТ ОСТАВИТЬ ОКОЛО ДВЕРИ'),
    (v_org_id, 'אנסטסיה', 'סטרוגי', '548054067', null::text, 'חולון צאלים 8/24', null::date, 'ПЛЮС МУЖСКОЙ ГЕЛЬ оплата при получении наличными 380 שק')
  ) AS t(org_id, first_name, last_name, phone, email, address, date_of_birth, notes)
  WHERE NOT EXISTS (
    SELECT 1 FROM clients c WHERE c.phone = t.phone
  );

  GET DIAGNOSTICS v_count = ROW_COUNT;
  RAISE NOTICE 'Imported % new clients (skipped duplicates by phone)', v_count;
END $$;

-- Show total for beautymania
SELECT COUNT(*) as total_clients FROM clients 
WHERE org_id = '1e77c781-3848-4b16-a623-693de123c6bc';
