# โ AFTERCARE INSTRUCTIONS - ะะะะะะะะฆะะฏ

**ะะฐัะฐ:** 2026-03-01
**ะัะพะตะบั:** Trinity CRM / Clientbase-Pro

---

## ๐ฆ ะงะขะ ะะะะะะะะะะะ

ะกะพะทะดะฐะฝ ะฝะพะฒัะน ัะฐะทะดะตะป "ะะฝััััะบัะธะธ ะฟะพ ััะพะดั" (Aftercare Instructions) ะฒ ะฝะฐัััะพะนะบะฐั ะพัะณะฐะฝะธะทะฐัะธะธ.

### ะกัััะบัััะฐ:
- **ะกััะฐะฝะธัะฐ:** `src/app/(dashboard)/settings/aftercare/page.tsx`
- **ะขะฐะฑะปะธัะฐ:** `aftercare_instructions`
- **API:** `/api/aftercare-instructions`
- **ะคัะฝะบัะธะพะฝะฐะป:**
  - โ ะกะฟะธัะพะบ ะธะฝััััะบัะธะน ั ะฝะฐะทะฒะฐะฝะธะตะผ ะธ ัะตะบััะพะผ
  - โ ะะฝะพะฟะบะฐ "ะะพะฑะฐะฒะธัั ะธะฝััััะบัะธั"
  - โ ะคะพัะผะฐ: ะฝะฐะทะฒะฐะฝะธะต (ืขืืจืืช/ััััะบะธะน), ัะตะบัั ะธะฝััััะบัะธะธ (textarea)
  - โ ะะฝะพะฟะบะธ: ัะตะดะฐะบัะธัะพะฒะฐัั, ัะดะฐะปะธัั
  - โ ะะดะฐะฟัะธะฒะฝัะน ะดะธะทะฐะนะฝ (ะผะพะฑะธะปัะฝัะน/ะดะตัะบัะพะฟ)
  - โ ะะพะดะดะตัะถะบะฐ ะฒัะตั ัะทัะบะพะฒ ัะธััะตะผั (ืขืืจืืช, ััััะบะธะน)

---

## ๐ ะกะะะะะะะซะ ะคะะะะซ

### 1. ะะฐะทะฐ ะดะฐะฝะฝัั
- `migrations/aftercare_instructions.sql` - SQL ะผะธะณัะฐัะธั

### 2. Backend
- `src/types/aftercare.ts` - TypeScript ัะธะฟั
- `src/hooks/useAftercareInstructions.ts` - React Query hooks
- `src/app/api/aftercare-instructions/route.ts` - API endpoint (GET, POST)
- `src/app/api/aftercare-instructions/[id]/route.ts` - API endpoint (PATCH, DELETE)

### 3. Frontend
- `src/app/(dashboard)/settings/aftercare/page.tsx` - ะะปะฐะฒะฝะฐั ัััะฐะฝะธัะฐ
- `src/components/aftercare/AftercareInstructionDialog.tsx` - ะะธะฐะปะพะณ ัะพะทะดะฐะฝะธั/ัะตะดะฐะบัะธัะพะฒะฐะฝะธั

### 4. ะะพะฝัะธะณััะฐัะธั
- ะะฑะฝะพะฒะปะตะฝ `src/contexts/LanguageContext.tsx` - ะดะพะฑะฐะฒะปะตะฝั ะฟะตัะตะฒะพะดั
- ะะฑะฝะพะฒะปะตะฝ `src/app/(dashboard)/settings/page.tsx` - ะดะพะฑะฐะฒะปะตะฝะฐ ัััะปะบะฐ ะฒ ะผะตะฝั
- ะะฑะฝะพะฒะปะตะฝ `src/hooks/usePermissions.ts` - ะดะพะฑะฐะฒะปะตะฝั ะฟัะฐะฒะฐ ะดะพัััะฟะฐ

---

## ๐๏ธ ะกะขะะฃะะขะฃะะ ะขะะะะะฆะซ

```sql
CREATE TABLE aftercare_instructions (
  id uuid DEFAULT gen_random_uuid() PRIMARY KEY,
  org_id uuid REFERENCES organizations(id) ON DELETE CASCADE NOT NULL,
  title text NOT NULL,
  title_ru text,
  content text NOT NULL,
  content_ru text,
  created_at timestamptz DEFAULT now() NOT NULL,
  updated_at timestamptz DEFAULT now() NOT NULL
);
```

**ะะฝะดะตะบัั:**
- `idx_aftercare_instructions_org_id`
- `idx_aftercare_instructions_created_at`

**RLS ะฟะพะปะธัะธะบะธ:**
- ะะพะปัะทะพะฒะฐัะตะปะธ ะผะพะณัั ะฟัะพัะผะฐััะธะฒะฐัั/ัะพะทะดะฐะฒะฐัั/ัะตะดะฐะบัะธัะพะฒะฐัั/ัะดะฐะปััั ะธะฝััััะบัะธะธ ัะฒะพะตะน ะพัะณะฐะฝะธะทะฐัะธะธ

---

## ๐ ะะะะะ ะะะกะขะฃะะ

- **ะะพัััะฟ:** ะขะพะปัะบะพ ะฒะปะฐะดะตะปะตั ะพัะณะฐะฝะธะทะฐัะธะธ (owner)
- **ะะฐะทัะตัะตะฝะธะต:** `canManageAftercareInstructions`
- ะะตะฝะตะดะถะตัั ะธ ะพะฑััะฝัะต ะฟะพะปัะทะพะฒะฐัะตะปะธ ะฝะต ะธะผะตัั ะดะพัััะฟะฐ ะบ ััะพะผั ัะฐะทะดะตะปั

---

## ๐ ะะะะะะะะซ

ะะพะฑะฐะฒะปะตะฝั ะฟะตัะตะฒะพะดั ะดะปั ะพะฑะพะธั ัะทัะบะพะฒ:

### ะะฒัะธั (ืขืืจืืช)
- `aftercareInstructions.title` - "ืืืจืืืช ืืืืจ ืืืืคืื"
- `aftercareInstructions.description` - "ืืื ืืืจืืืช ืืืืืืช ืืืงืืืืช ืืืืจ ืืฉืืจืืชืื"
- ะ ะดััะณะธะต...

### ะัััะบะธะน
- `aftercareInstructions.title` - "ะะฝััััะบัะธะธ ะฟะพ ััะพะดั"
- `aftercareInstructions.description` - "ะฃะฟัะฐะฒะปะตะฝะธะต ะพะฑัะธะผะธ ะธะฝััััะบัะธัะผะธ ะดะปั ะบะปะธะตะฝัะพะฒ ะฟะพัะปะต ััะปัะณ"
- ะ ะดััะณะธะต...

---

## ๐ฑ ะะะะะขะะะะะกะขะฌ

- **ะะตัะบัะพะฟ:** ะขะฐะฑะปะธัะฐ ั ะบะพะปะพะฝะบะฐะผะธ (ะฝะฐะทะฒะฐะฝะธะต, ัะพะดะตัะถะฐะฝะธะต, ะดะตะนััะฒะธั)
- **ะะพะฑะธะปัะฝัะน:** ะะฐััะพัะบะธ ั ะบะฝะพะฟะบะฐะผะธ ัะตะดะฐะบัะธัะพะฒะฐะฝะธั/ัะดะฐะปะตะฝะธั
- Responsive ะดะธะทะฐะนะฝ ัะฐะฑะพัะฐะตั ะฝะฐ ะฒัะตั ััััะพะนััะฒะฐั

---

## ๐ ะะะ ะะะะะะะะขะฌ ะะะะะะฆะะฎ

### ะะฐัะธะฐะฝั 1: ะงะตัะตะท Supabase Dashboard (ะะตะบะพะผะตะฝะดัะตััั)

1. ะัะบัะพะน [Supabase Dashboard](https://supabase.com/dashboard)
2. ะัะฑะตัะธ ะฟัะพะตะบั: **tjryzcqvsavtllahjyrj**
3. ะะตัะตะนะดะธ ะฒ **SQL Editor** (ะปะตะฒะพะต ะผะตะฝั)
4. ะะฐะถะผะธ **New query**
5. ะกะบะพะฟะธััะน ัะพะดะตัะถะธะผะพะต ัะฐะนะปะฐ `migrations/aftercare_instructions.sql`
6. ะััะฐะฒั ะฒ ัะตะดะฐะบัะพั
7. ะะฐะถะผะธ **Run** โถ๏ธ
8. ะัะพะฒะตัั ัะตะทัะปััะฐั: ะดะพะปะถะฝะพ ะฑััั โ "Success. No rows returned"

### ะะฐัะธะฐะฝั 2: ะงะตัะตะท Supabase CLI (ะตัะปะธ ัััะฐะฝะพะฒะปะตะฝ)

```bash
cd /home/node/.openclaw/workspace/Leya-Project/clientbase-pro
supabase db push
```

---

## ๐ง ะขะะกะขะะะะะะะะ

ะะพัะปะต ะฟัะธะผะตะฝะตะฝะธั ะผะธะณัะฐัะธะธ:

1. ะะพะนะดะธ ะฒ ัะธััะตะผั ะบะฐะบ ะฒะปะฐะดะตะปะตั ะพัะณะฐะฝะธะทะฐัะธะธ
2. ะะตัะตะนะดะธ ะฒ **ะะฐัััะพะนะบะธ** โ **ะะฝััััะบัะธะธ ะฟะพ ััะพะดั**
3. ะะฐะถะผะธ **ะะพะฑะฐะฒะธัั ะธะฝััััะบัะธั**
4. ะะฐะฟะพะปะฝะธ ัะพัะผั:
   - ะะฐะทะฒะฐะฝะธะต (ืขืืจืืช): "ืืืืจ ืฆืืืขืช ืฉืืขืจ"
   - ะะฐะทะฒะฐะฝะธะต (ััััะบะธะน): "ะะพัะปะต ะพะบัะฐัะธะฒะฐะฝะธั ะฒะพะปะพั"
   - ะขะตะบัั (ืขืืจืืช): "ืืื ืืฉืืืฃ ืฉืืขืจ ืืืฉื 24 ืฉืขืืช"
   - ะขะตะบัั (ััััะบะธะน): "ะะต ะผะพะนัะต ะฒะพะปะพัั ะฒ ัะตัะตะฝะธะต 24 ัะฐัะพะฒ"
5. ะะฐะถะผะธ **ะกะพััะฐะฝะธัั**
6. ะัะพะฒะตัั ััะพ ะธะฝััััะบัะธั ะพัะพะฑัะฐะถะฐะตััั ะฒ ัะฟะธัะบะต
7. ะัะพะฒะตัั ัะตะดะฐะบัะธัะพะฒะฐะฝะธะต ะธ ัะดะฐะปะตะฝะธะต

---

## ๐ฆ ะะะะะะ

```bash
# ะะพะผะผะธั ะธะทะผะตะฝะตะฝะธะน
cd /home/node/.openclaw/workspace/Leya-Project/clientbase-pro
git add .
git commit -m "feat: add aftercare instructions management"

# ะะตะฟะปะพะน ะฝะฐ GitHub
git push origin main
```

**Vercel** ะฐะฒัะพะผะฐัะธัะตัะบะธ ะทะฐะดะตะฟะปะพะธั ะธะทะผะตะฝะตะฝะธั ะฟะพัะปะต push ะฒ main ะฒะตัะบั.

---

## โ ะงะะะะะกะข

- [x] SQL ะผะธะณัะฐัะธั ัะพะทะดะฐะฝะฐ
- [x] ะขะธะฟั TypeScript ัะพะทะดะฐะฝั
- [x] API endpoints ัะพะทะดะฐะฝั (GET, POST, PATCH, DELETE)
- [x] React Query hooks ัะพะทะดะฐะฝั
- [x] ะะพะผะฟะพะฝะตะฝั ะดะธะฐะปะพะณะฐ ัะพะทะดะฐะฝ
- [x] ะกััะฐะฝะธัะฐ ะฝะฐัััะพะตะบ ัะพะทะดะฐะฝะฐ
- [x] ะะตัะตะฒะพะดั ะดะพะฑะฐะฒะปะตะฝั (ืขืืจืืช, ััััะบะธะน)
- [x] ะะตะฝั ะฝะฐัััะพะตะบ ะพะฑะฝะพะฒะปะตะฝะพ
- [x] ะัะฐะฒะฐ ะดะพัััะฟะฐ ะฝะฐัััะพะตะฝั
- [x] Responsive ะดะธะทะฐะนะฝ ัะตะฐะปะธะทะพะฒะฐะฝ
- [ ] SQL ะผะธะณัะฐัะธั ะฟัะธะผะตะฝะตะฝะฐ (ะฝัะถะฝะพ ะฒัะฟะพะปะฝะธัั ะฒัััะฝัั)
- [ ] ะขะตััะธัะพะฒะฐะฝะธะต ะฒัะฟะพะปะฝะตะฝะพ
- [ ] ะะตะฟะปะพะน ะฒัะฟะพะปะฝะตะฝ

---

## ๐ ะะะะะะงะะะะฏ

- ะขะฐะฑะปะธัะฐ `aftercare_instructions` - ัะฟัะพััะฝะฝะฐั ะฒะตััะธั ะฑะตะท ะฟัะธะฒัะทะบะธ ะบ ััะปัะณะฐะผ
- ะัะปะธัะฐะตััั ะพั `care_instructions` (ะบะพัะพัะฐั ะฟัะธะฒัะทะฐะฝะฐ ะบ `services`)
- RLS ะฟะพะปะธัะธะบะธ ะฝะฐัััะพะตะฝั ะดะปั ะฑะตะทะพะฟะฐัะฝะพััะธ ะดะฐะฝะฝัั
- ะะพะดะดะตัะถะธะฒะฐะตั ะพะฑะต ัะทัะบะพะฒัะต ะฒะตััะธะธ ัะธััะตะผั

---

## ๐ ะกะกะซะะะ

- **Supabase Project:** https://tjryzcqvsavtllahjyrj.supabase.co
- **SQL Migration:** `/migrations/aftercare_instructions.sql`
- **Page:** `/settings/aftercare`

---

โ **ะะพัะพะฒะพ ะบ ะฟัะธะผะตะฝะตะฝะธั!**
